# 1 "hxhxmacrohost_MacroRuntime.ml"
(* Generated by reflaxe.ocaml (WIP) *)
(* Haxe type: hxhxmacrohost.MacroRuntime *)

let __reflaxe_ocaml__ = ()

type t = { __hx_type : Obj.t }

let create = fun () -> let self = ({ __hx_type = HxType.class_ "hxhxmacrohost.MacroRuntime" } : t) in (
  ignore ();
  self
)

let __empty = fun () -> ({ __hx_type = HxType.class_ "hxhxmacrohost.MacroRuntime" } : t)

let builtinTypeDesc = fun name -> let tempResult = ref "" in (
  ignore (match name with
    | "Bool" | "Float" | "Int" | "String" | "Void" -> let __assign_13 = "builtin:" ^ HxString.toStdString name in (
      tempResult := __assign_13;
      __assign_13
    )
    | _ -> let __assign_12 = "unknown:" ^ HxString.toStdString name in (
      tempResult := __assign_12;
      __assign_12
    ));
  !tempResult
)

let defines = HxMap.create_string ()

let afterTypingHooks = let __arr_14 = HxArray.create () in __arr_14

let registerAfterTyping = fun cb -> (
  ignore (HxArray.push afterTypingHooks cb);
  HxInt.sub (HxArray.length afterTypingHooks) 1
)

let onGenerateHooks = let __arr_15 = HxArray.create () in __arr_15

let registerOnGenerate = fun cb -> (
  ignore (HxArray.push onGenerateHooks cb);
  HxInt.sub (HxArray.length onGenerateHooks) 1
)

let afterGenerateHooks = let __arr_16 = HxArray.create () in __arr_16

let registerAfterGenerate = fun cb -> (
  ignore (HxArray.push afterGenerateHooks cb);
  HxInt.sub (HxArray.length afterGenerateHooks) 1
)

let runHook = fun kind id -> (
  ignore (if kind == Obj.magic (HxRuntime.hx_null) then ignore (HxType.hx_throw_typed_rtti (Obj.repr "MacroRuntime.runHook: missing kind") ["Dynamic"; "String"]) else ());
  ignore (if id < 0 then ignore (HxType.hx_throw_typed_rtti (Obj.repr ("MacroRuntime.runHook: invalid hook id: " ^ string_of_int id)) ["Dynamic"; "String"]) else ());
  match kind with
    | "afterGenerate" -> ignore ((
      ignore (if id >= HxArray.length afterGenerateHooks then ignore (HxType.hx_throw_typed_rtti (Obj.repr ("MacroRuntime.runHook: unknown afterGenerate hook id: " ^ string_of_int id)) ["Dynamic"; "String"]) else ());
      HxArray.get afterGenerateHooks id ()
    ))
    | "afterTyping" -> ignore ((
      ignore (if id >= HxArray.length afterTypingHooks then ignore (HxType.hx_throw_typed_rtti (Obj.repr ("MacroRuntime.runHook: unknown afterTyping hook id: " ^ string_of_int id)) ["Dynamic"; "String"]) else ());
      HxArray.get afterTypingHooks id (let __arr_10 = HxArray.create () in __arr_10)
    ))
    | "onGenerate" -> ignore ((
      ignore (if id >= HxArray.length onGenerateHooks then ignore (HxType.hx_throw_typed_rtti (Obj.repr ("MacroRuntime.runHook: unknown onGenerate hook id: " ^ string_of_int id)) ["Dynamic"; "String"]) else ());
      HxArray.get onGenerateHooks id (let __arr_11 = HxArray.create () in __arr_11)
    ))
    | _ -> ignore (HxType.hx_throw_typed_rtti (Obj.repr ("MacroRuntime.runHook: unknown kind: " ^ HxString.toStdString kind)) ["Dynamic"; "String"])
)

let currentBuildFieldNames = ref (let __arr_17 = HxArray.create () in __arr_17 : string HxArray.t)

let hasCurrentBuildFieldName = fun name -> try (
  ignore (if name == Obj.magic (HxRuntime.hx_null) || HxString.length name = 0 then raise (HxRuntime.Hx_return (Obj.repr false)) else ());
  HxArray.indexOf (!currentBuildFieldNames) name 0 <> -1
) with
  | HxRuntime.Hx_return __ret_9 -> Obj.obj __ret_9

let hasBuildFieldSnapshot = ref (false : bool)

let setCurrentBuildFieldNames = fun names -> let tempRight = ref (Obj.magic ()) in (
  ignore (if names == Obj.magic (HxRuntime.hx_null) then let __assign_1 = let __arr_2 = HxArray.create () in __arr_2 in (
    tempRight := __assign_1;
    __assign_1
  ) else let __assign_3 = HxArray.copy names in (
    tempRight := __assign_3;
    __assign_3
  ));
  ignore (let __assign_4 = !tempRight in (
    currentBuildFieldNames := __assign_4;
    __assign_4
  ));
  let __assign_5 = true in (
    hasBuildFieldSnapshot := __assign_5;
    __assign_5
  )
)

let clearCurrentBuildFieldSnapshot = fun () -> (
  ignore (let __assign_6 = let __arr_7 = HxArray.create () in __arr_7 in (
    currentBuildFieldNames := __assign_6;
    __assign_6
  ));
  let __assign_8 = false in (
    hasBuildFieldSnapshot := __assign_8;
    __assign_8
  )
)

let hasCurrentBuildFieldSnapshot = fun () -> !hasBuildFieldSnapshot