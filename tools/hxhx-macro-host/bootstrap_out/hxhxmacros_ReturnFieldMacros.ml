# 1 "hxhxmacros_ReturnFieldMacros.ml"
(* Generated by reflaxe.ocaml (WIP) *)
(* Haxe type: hxhxmacros.ReturnFieldMacros *)

let __reflaxe_ocaml__ = ()

type t = { __hx_type : Obj.t }

let create = fun () -> let self = ({ __hx_type = HxType.class_ "hxhxmacros.ReturnFieldMacros" } : t) in (
  ignore ();
  self
)

let __empty = fun () -> ({ __hx_type = HxType.class_ "hxhxmacros.ReturnFieldMacros" } : t)

let addGeneratedFieldReturn = fun () -> let fields = Haxe_macro_Context.getBuildFields () in let traceCall = let __anon_1 = HxAnon.create () in (
  ignore (HxAnon.set __anon_1 "expr" (Obj.repr (Haxe_macro_Expr.ECall ((let __anon_2 = HxAnon.create () in (
    ignore (HxAnon.set __anon_2 "expr" (Obj.repr (Haxe_macro_Expr.EConst (Haxe_macro_Expr.CIdent "trace"))));
    ignore (HxAnon.set __anon_2 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
    __anon_2
  )), (let __arr_3 = HxArray.create () in (
    ignore (HxArray.push __arr_3 (let __anon_4 = HxAnon.create () in (
      ignore (HxAnon.set __anon_4 "expr" (Obj.repr (Haxe_macro_Expr.EConst (Haxe_macro_Expr.CString ("from_hxhx_build_macro_return", HxEnum.box_if_needed "haxe.macro.StringLiteralKind" (Obj.repr (Haxe_macro_Expr.DoubleQuotes)))))));
      ignore (HxAnon.set __anon_4 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
      __anon_4
    )));
    __arr_3
  ))))));
  ignore (HxAnon.set __anon_1 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
  __anon_1
) in let body = let __anon_5 = HxAnon.create () in (
  ignore (HxAnon.set __anon_5 "expr" (Obj.repr (Haxe_macro_Expr.EBlock (let __arr_6 = HxArray.create () in (
    ignore (HxArray.push __arr_6 traceCall);
    __arr_6
  )))));
  ignore (HxAnon.set __anon_5 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
  __anon_5
) in (
  ignore (HxArray.push fields (let __anon_7 = HxAnon.create () in (
    ignore (HxAnon.set __anon_7 "name" (Obj.repr "generated_return"));
    ignore (HxAnon.set __anon_7 "access" (Obj.repr (let __arr_8 = HxArray.create () in (
      ignore (HxArray.push __arr_8 (Haxe_macro_Expr.APublic));
      ignore (HxArray.push __arr_8 (Haxe_macro_Expr.AStatic));
      __arr_8
    ))));
    ignore (HxAnon.set __anon_7 "kind" (Obj.repr (Haxe_macro_Expr.FFun (let __anon_9 = HxAnon.create () in (
      ignore (HxAnon.set __anon_9 "args" (Obj.repr (let __arr_10 = HxArray.create () in __arr_10)));
      ignore (HxAnon.set __anon_9 "expr" (Obj.repr body));
      __anon_9
    )))));
    ignore (HxAnon.set __anon_7 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
    __anon_7
  )));
  fields
)

let replaceGeneratedFieldReturn = fun () -> let fields = Haxe_macro_Context.getBuildFields () in let traceCall = let __anon_11 = HxAnon.create () in (
  ignore (HxAnon.set __anon_11 "expr" (Obj.repr (Haxe_macro_Expr.ECall ((let __anon_12 = HxAnon.create () in (
    ignore (HxAnon.set __anon_12 "expr" (Obj.repr (Haxe_macro_Expr.EConst (Haxe_macro_Expr.CIdent "trace"))));
    ignore (HxAnon.set __anon_12 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
    __anon_12
  )), (let __arr_13 = HxArray.create () in (
    ignore (HxArray.push __arr_13 (let __anon_14 = HxAnon.create () in (
      ignore (HxAnon.set __anon_14 "expr" (Obj.repr (Haxe_macro_Expr.EConst (Haxe_macro_Expr.CString ("from_hxhx_build_macro_replaced", HxEnum.box_if_needed "haxe.macro.StringLiteralKind" (Obj.repr (Haxe_macro_Expr.DoubleQuotes)))))));
      ignore (HxAnon.set __anon_14 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
      __anon_14
    )));
    __arr_13
  ))))));
  ignore (HxAnon.set __anon_11 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
  __anon_11
) in let body = let __anon_15 = HxAnon.create () in (
  ignore (HxAnon.set __anon_15 "expr" (Obj.repr (Haxe_macro_Expr.EBlock (let __arr_16 = HxArray.create () in (
    ignore (HxArray.push __arr_16 traceCall);
    __arr_16
  )))));
  ignore (HxAnon.set __anon_15 "pos" (Obj.repr (Obj.magic (HxRuntime.hx_null))));
  __anon_15
) in let _g = ref 0 in (
  ignore (try while !_g < HxArray.length fields do try ignore (let f = HxArray.get fields (!_g) in (
    ignore (let __old_17 = !_g in let __new_18 = HxInt.add __old_17 1 in (
      ignore (_g := __new_18);
      __new_18
    ));
    ignore (if f == Obj.magic (HxRuntime.hx_null) || not (HxString.equals (Obj.obj (HxAnon.get f "name")) "generated_replace") then raise (HxRuntime.Hx_continue) else ());
    let _g2 = Obj.obj (HxAnon.get f "kind") in if (match _g2 with
      | Haxe_macro_Expr.FVar (_, _) -> 0
      | Haxe_macro_Expr.FFun _ -> 1
      | Haxe_macro_Expr.FProp (_, _, _, _) -> 2) = 1 then ignore (let _g3 = match _g2 with
      | Haxe_macro_Expr.FFun __enum_param_19 -> __enum_param_19
      | _ -> failwith "Unexpected enum parameter" in let fn = _g3 in if fn != Obj.magic (HxRuntime.hx_null) then ignore (let __assign_20 = body in (
      HxAnon.set fn "expr" (Obj.repr __assign_20);
      __assign_20
    )) else ()) else ignore ()
  )) with
    | HxRuntime.Hx_continue -> () done with
    | HxRuntime.Hx_break -> ());
  fields
)