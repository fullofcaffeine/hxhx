# 1 "TyType.ml"
(* Generated by reflaxe.ocaml (WIP) *)
(* Haxe type: TyType *)

let __reflaxe_ocaml__ = ()

type t = { __hx_type : Obj.t; mutable display : string }

let create = fun display2 -> let self = ({ __hx_type = HxType.class_ "TyType"; display = "" } : t) in (
  ignore (let __assign_1 = display2 in (
    self.display <- __assign_1;
    __assign_1
  ));
  self
)

let __empty = fun () -> ({ __hx_type = HxType.class_ "TyType"; display = "" } : t)

let isUnknown = fun self () -> HxString.equals (self.display) "Unknown"

let isVoid = fun self () -> HxString.equals (self.display) "Void"

let isNumeric = fun self () -> HxString.equals (self.display) "Int" || HxString.equals (self.display) "Float"

let toString = fun self () -> self.display

let getDisplay = fun self () -> self.display

let unknown = fun () -> create "Unknown"

let fromHintText = fun hint -> try (
  ignore (if hint == Obj.magic (HxRuntime.hx_null) then raise (HxRuntime.Hx_return (Obj.repr (unknown ()))) else ());
  let s = StringTools.trim hint in (
    ignore (if HxString.length s = 0 then raise (HxRuntime.Hx_return (Obj.repr (unknown ()))) else ());
    let tempResult = ref (Obj.magic ()) in (
      ignore (match s with
        | "Bool" | "Dynamic" | "Float" | "Int" | "String" | "Void" -> let __assign_3 = create s in (
          tempResult := __assign_3;
          __assign_3
        )
        | _ -> let __assign_2 = create s in (
          tempResult := __assign_2;
          __assign_2
        ));
      !tempResult
    )
  )
) with
  | HxRuntime.Hx_return __ret_4 -> Obj.obj __ret_4

let unify = fun a b -> try (
  ignore (if a == Obj.magic (HxRuntime.hx_null) || b == Obj.magic (HxRuntime.hx_null) then raise (HxRuntime.Hx_return (Obj.repr (Obj.magic (HxRuntime.hx_null)))) else ());
  ignore (if isUnknown a () then raise (HxRuntime.Hx_return (Obj.repr b)) else ());
  ignore (if isUnknown b () then raise (HxRuntime.Hx_return (Obj.repr a)) else ());
  ignore (if HxString.equals (a.display) (b.display) then raise (HxRuntime.Hx_return (Obj.repr a)) else ());
  ignore (if HxString.equals (a.display) "Null" then raise (HxRuntime.Hx_return (Obj.repr b)) else ());
  ignore (if HxString.equals (b.display) "Null" then raise (HxRuntime.Hx_return (Obj.repr a)) else ());
  ignore (if isNumeric a () && isNumeric b () then raise (HxRuntime.Hx_return (Obj.repr (create "Float"))) else ());
  ignore (if HxString.equals (a.display) "Dynamic" then raise (HxRuntime.Hx_return (Obj.repr a)) else ());
  ignore (if HxString.equals (b.display) "Dynamic" then raise (HxRuntime.Hx_return (Obj.repr b)) else ());
  Obj.magic (HxRuntime.hx_null)
) with
  | HxRuntime.Hx_return __ret_5 -> Obj.obj __ret_5