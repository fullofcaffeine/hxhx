# 1 "haxe_io_FPHelper.ml"
(* Generated by reflaxe.ocaml (WIP) *)
(* Haxe type: haxe.io.FPHelper *)

let __reflaxe_ocaml__ = ()

let i32ToFloat = fun i -> let tempResult = ref 0. in let sign = HxInt.sub 1 (HxInt.shl (HxInt.ushr i 31) 1) in let e = HxInt.logand (HxInt.shr i 23) 255 in (
  ignore (if e = 255 then if HxInt.logand i 8388607 = 0 then if sign > 0 then let __assign_1 = Math.positive_infinity in (
    tempResult := __assign_1;
    __assign_1
  ) else let __assign_2 = Math.negative_infinity in (
    tempResult := __assign_2;
    __assign_2
  ) else let __assign_3 = Math.nan in (
    tempResult := __assign_3;
    __assign_3
  ) else let tempNumber = ref 0 in (
    ignore (if e = 0 then let __assign_4 = HxInt.shl (HxInt.logand i 8388607) 1 in (
      tempNumber := __assign_4;
      __assign_4
    ) else let __assign_5 = HxInt.logor (HxInt.logand i 8388607) 8388608 in (
      tempNumber := __assign_5;
      __assign_5
    ));
    let m = !tempNumber in let __assign_6 = float_of_int (HxInt.mul sign m) *. Math.pow (float_of_int 2) (float_of_int (HxInt.sub e 150)) in (
      tempResult := __assign_6;
      __assign_6
    )
  ));
  !tempResult
)

let floatToI32 = fun f -> let tempResult = ref 0 in (
  ignore (if f = float_of_int 0 then let __assign_7 = 0 in (
    tempResult := __assign_7;
    __assign_7
  ) else let tempNumber = ref 0. in (
    ignore (if f < float_of_int 0 then let __assign_8 = -.f in (
      tempNumber := __assign_8;
      __assign_8
    ) else let __assign_9 = f in (
      tempNumber := __assign_9;
      __assign_9
    ));
    let af = ref (!tempNumber) in let exp = ref (Math.floor (Math.log (!af) /. 0.6931471805599453)) in if !exp > 127 then let __assign_10 = 2139095040 in (
      tempResult := __assign_10;
      __assign_10
    ) else (
      ignore (if !exp <= -127 then ignore ((
        ignore (let __assign_11 = -127 in (
          exp := __assign_11;
          __assign_11
        ));
        af := !af *. 7.1362384635298e+44
      )) else ignore (let __assign_12 = (!af /. Math.pow (float_of_int 2) (float_of_int (!exp)) -. 1.0) *. float_of_int 8388608 in (
        af := __assign_12;
        __assign_12
      )));
      let tempNumber1 = ref 0 in (
        ignore (if f < float_of_int 0 then let __assign_13 = -2147483648 in (
          tempNumber1 := __assign_13;
          __assign_13
        ) else let __assign_14 = 0 in (
          tempNumber1 := __assign_14;
          __assign_14
        ));
        let __assign_15 = HxInt.logor (HxInt.logor (!tempNumber1) (HxInt.shl (HxInt.add (!exp) 127) 23)) (Math.round (!af)) in (
          tempResult := __assign_15;
          __assign_15
        )
      )
    )
  ));
  !tempResult
)

let i64ToDouble = fun low high -> let tempResult = ref 0. in let sign = HxInt.sub 1 (HxInt.shl (HxInt.ushr high 31) 1) in let e = HxInt.logand (HxInt.shr high 20) 2047 in (
  ignore (if e = 2047 then if low = 0 && HxInt.logand high 1048575 = 0 then if sign > 0 then let __assign_16 = Math.positive_infinity in (
    tempResult := __assign_16;
    __assign_16
  ) else let __assign_17 = Math.negative_infinity in (
    tempResult := __assign_17;
    __assign_17
  ) else let __assign_18 = Math.nan in (
    tempResult := __assign_18;
    __assign_18
  ) else let m = 2.220446049250313e-16 *. (float_of_int (HxInt.logand high 1048575) *. 4294967296. +. float_of_int (HxInt.ushr low 31) *. 2147483648. +. float_of_int (HxInt.logand low 2147483647)) in let tempRight = ref 0. in (
    ignore (if e = 0 then let __assign_19 = m *. 2.0 in (
      tempRight := __assign_19;
      __assign_19
    ) else let __assign_20 = m +. 1.0 in (
      tempRight := __assign_20;
      __assign_20
    ));
    let m = !tempRight in let __assign_21 = float_of_int sign *. m *. Math.pow (float_of_int 2) (float_of_int (HxInt.sub e 1023)) in (
      tempResult := __assign_21;
      __assign_21
    )
  ));
  !tempResult
)

let i64tmp = let x = Haxe_Int64.___int64_create 0 0 in let this1 = x in this1

let doubleToI64 = fun v -> let i64 = i64tmp in (
  ignore (if v = float_of_int 0 then ignore ((
    ignore (let __assign_22 = 0 in (
      i64.low <- __assign_22;
      __assign_22
    ));
    let __assign_23 = 0 in (
      i64.high <- __assign_23;
      __assign_23
    )
  )) else ignore (if not (Math.isFinite v) then ignore ((
    ignore (let __assign_24 = 0 in (
      i64.low <- __assign_24;
      __assign_24
    ));
    let tempRight = ref (Obj.magic ()) in (
      ignore (if v > float_of_int 0 then let __assign_25 = 2146435072 in (
        tempRight := __assign_25;
        __assign_25
      ) else let __assign_26 = -1048576 in (
        tempRight := __assign_26;
        __assign_26
      ));
      let __assign_27 = !tempRight in (
        i64.high <- __assign_27;
        __assign_27
      )
    )
  )) else ignore (let tempNumber = ref 0. in (
    ignore (if v < float_of_int 0 then let __assign_28 = -.v in (
      tempNumber := __assign_28;
      __assign_28
    ) else let __assign_29 = v in (
      tempNumber := __assign_29;
      __assign_29
    ));
    let av = ref (!tempNumber) in let exp = ref (Math.floor (Math.log (!av) /. 0.6931471805599453)) in if !exp > 1023 then ignore ((
      ignore (let __assign_30 = -1 in (
        i64.low <- __assign_30;
        __assign_30
      ));
      let __assign_31 = 2146435071 in (
        i64.high <- __assign_31;
        __assign_31
      )
    )) else ignore ((
      ignore (if !exp <= -1023 then ignore ((
        ignore (let __assign_32 = -1023 in (
          exp := __assign_32;
          __assign_32
        ));
        let __assign_33 = !av /. 2.2250738585072014e-308 in (
          av := __assign_33;
          __assign_33
        )
      )) else ignore (let __assign_34 = !av /. Math.pow (float_of_int 2) (float_of_int (!exp)) -. 1.0 in (
        av := __assign_34;
        __assign_34
      )));
      let hx_sig = Math.fround (!av *. 4503599627370496.) in let sig_l = int_of_float hx_sig in let sig_h = int_of_float (hx_sig /. 4294967296.0) in (
        ignore (let __assign_35 = sig_l in (
          i64.low <- __assign_35;
          __assign_35
        ));
        let tempNumber1 = ref 0 in (
          ignore (if v < float_of_int 0 then let __assign_36 = -2147483648 in (
            tempNumber1 := __assign_36;
            __assign_36
          ) else let __assign_37 = 0 in (
            tempNumber1 := __assign_37;
            __assign_37
          ));
          let __assign_38 = HxInt.logor (HxInt.logor (!tempNumber1) (HxInt.shl (HxInt.add (!exp) 1023) 20)) sig_h in (
            i64.high <- __assign_38;
            __assign_38
          )
        )
      )
    ))
  ))));
  i64
)